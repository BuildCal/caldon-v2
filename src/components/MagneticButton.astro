---
interface Props {
  href?: string;
  class?: string;
  variant?: 'primary' | 'secondary';
}

const { href, class: className = '', variant = 'primary' } = Astro.props;
const buttonId = `magnetic-${Math.random().toString(36).substr(2, 9)}`;
---

{href ? (
  <a href={href} class={`magnetic-button magnetic-${variant} ${className}`} data-magnetic-id={buttonId}>
    <slot />
  </a>
) : (
  <button class={`magnetic-button magnetic-${variant} ${className}`} data-magnetic-id={buttonId}>
    <slot />
  </button>
)}

<style>
  .magnetic-button {
    position: relative;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: var(--space-lg) var(--space-3xl);
    font-size: var(--text-xs);
    font-weight: 500;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    border: none;
    cursor: pointer;
    transition: all var(--transition-base) var(--ease-out);
    overflow: hidden;
    text-decoration: none;
    will-change: transform;
  }
  
  .magnetic-primary {
    color: var(--color-background);
    background-color: var(--color-primary);
  }
  
  .magnetic-secondary {
    color: var(--color-primary);
    background-color: transparent;
    border: 1px solid var(--color-primary);
  }
  
  .magnetic-button::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background-color: var(--color-accent);
    transition: left var(--transition-base) var(--ease-out);
    z-index: -1;
  }
  
  .magnetic-button:hover::before {
    left: 0;
  }
  
  .magnetic-secondary:hover {
    background-color: var(--color-primary);
    color: var(--color-background);
  }
</style>

<script>
  const button = document.querySelector(`[data-magnetic-id="${buttonId}"]`);
  if (button) {
    const magneticStrength = 30;
    
    button.addEventListener('mousemove', (e) => {
      const rect = button.getBoundingClientRect();
      const x = e.clientX - rect.left - rect.width / 2;
      const y = e.clientY - rect.top - rect.height / 2;
      
      const moveX = (x / rect.width) * magneticStrength;
      const moveY = (y / rect.height) * magneticStrength;
      
      button.style.transform = `translate(${moveX}px, ${moveY}px)`;
    });
    
    button.addEventListener('mouseleave', () => {
      button.style.transform = 'translate(0, 0)';
    });
  }
</script>

